<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<title>Bindr: Google Analytics Download Tracking</title>
	<meta name="description" content="Software Engineer. JavaScript. Ruby. Rails.">
	<meta name="author" content="Tian Davis">
	
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="/stylesheets/base.css">
	<link rel="stylesheet" href="/stylesheets/skeleton.css">
	<link rel="stylesheet" href="/stylesheets/layout.css">
	<link rel="stylesheet" href="/stylesheets/docs.css">
	<link rel="stylesheet" href="/stylesheets/syntax.css">

	<!-- Favicon
	================================================== -->
	<link rel="shortcut icon" href="/images/favicon.ico">
	<link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

</head>
<body data-twttr-rendered="true">
			<div class="container">
				<div class="three columns sidebar">
					<nav>
						<h3 id="logo">Spartan</h3>
						
						<ul>
							<li class="icon blog"><a href="/">Blog</a></li>
							<li class="icon email"><a href="mailto:hello@tiandavis.com">Email</a></li>
							<li class="icon twitter"><a href="https://twitter.com/tiandavis">Twitter</a></li>
							<li class="icon github"><a href="https://github.com/tiandavis">Github</a></li>
						</ul>
					</nav>
					&nbsp;
				</div>
				
				<div class="twelve columns offset-by-one content">
					<div class="doc-section clearfix post" id="typography">
	<h2>Bindr: Google Analytics Download Tracking</h2>
	
	<p>Google Analytics doesn&#39;t track file downloads automatically. I needed unobtrusive and framework agnostic download tracking for Google Analytics. That&#39;s when <a href="https://github.com/tiandavis/bindr">Bindr</a> was born.</p>

<p>Bindr is Automatic Download Tracking for Asynchronous Google Analytics.</p>

<h3>Why Bindr?</h3>

<p>To be honest, I wish this extension wasn&#39;t necessary. I wish Google Analytics tracked file downloads automatically and out-of-the-box, but it doesn&#39;t. An extension was needed - so be it. But if it was going to be done, I wanted to make sure it was done right!</p>

<p>I set goals for Bindr before a single line of code was written. Bindr needed to embody the following:</p>

<ol>
<li>Automatic Tracking</li>
<li>Framework Agnostic</li>
<li>Unobtrusive JavaScript</li>
<li>Small Footprint</li>
</ol>

<h4>Automatic</h4>

<p>Google suggests adding an onClick event to each anchor tag you use for file downloads. I don&#39;t want to have to do that each time I have a download. I would rather drop an extension that would do this consistently and automatically each time.</p>

<p>Bindr automatically tracks the name and extension of each file downloaded with the following convention:</p>

<p><em>/download/fileName.extension</em></p>

<p>For example, in Google Analytics Top Content, the downloads Bindr would look like:</p>

<p><em>/download/bindr.zip       1,504</em></p>

<h4>Framework Agnostic</h4>

<p>Bindr also had to be framework agnostic. I know a lot of people have or will roll framework specific solutions. That&#39;s great for them, but it wasn&#39;t going to work for me.</p>

<p>I use and love jQuery just as much as the other guy. In fact, I use it in all of my company&#39;s products. That said, there are people with just as much love for Prototype.js or MooTools.</p>

<p>I respect that. I don&#39;t believe they should have to download another framework in this case. I don&#39;t believe a framework is critical to this solution scope at all.</p>

<h4>Unobtrusive JavaScript</h4>

<p>This is Google&#39;s recommended way to track downloads:</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://www.example.com/files/map.pdf&quot;</span> <span class="na">onClick=</span><span class="s">&quot;javascript: _gaq.push([&#39;_trackPageview&#39;, &#39;/downloads/map&#39;]);&quot;</span><span class="nt">&gt;</span>
</code></pre></div>
 

<p>I believe in standards based development. I believe we honor our profession when we encourage each other towards best practices.</p>

<p>Inline JavaScript is not a best practice. Inline JavaScript mixes structure with behavior in a most unnecessary mixing of concerns. The example is just plain sloppy. </p>

<p>I believed then and I believe now that the spirit of the solution is best honored with an Unobtrusive implementation that leaves the structure of the HTML5 markup clean and readable. Bindr does just that.</p>

<h4>Small Footprint</h4>

<p>The final goal of the project was to have a small footprint. I needed something that was fast to download and painless to install in each project. I needed the extension to be as small as possible.</p>

<p>Here&#39;s were we are at today:</p>

<p><strong>Original Size:</strong>  1.54KB (772 bytes gzipped)</p>

<p><strong>Compiled Size:</strong>  579 bytes (339 bytes gzipped)</p>

<p>Saved <strong>63.21%</strong> off the original size (<strong>56.09%</strong> off the gzipped size)</p>

<p>Compiled and gzipped, Bindr is less than 1kb. It&#39;s fast, dependable and - for now - I&#39;m happy with the results.</p>

<h3>Installation Guide</h3>

<p>Installation is clean and simple. Download <a href="https://github.com/tiandavis/bindr">Bindr</a>. Place the following script declaration in you head tag:</p>

<div class="highlight"><pre><code class="html">    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;javascripts/bindr.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>

<p>Just above your Google Analytics Queue array declaration:</p>

<div class="highlight"><pre><code class="html">    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
      <span class="kd">var</span> <span class="nx">_gaq</span> <span class="o">=</span> <span class="nx">_gaq</span> <span class="o">||</span> <span class="p">[];</span>
      <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_setAccount&#39;</span><span class="p">,</span> <span class="s1">&#39;UA-XXXXXXXX-X&#39;</span><span class="p">]);</span>
      <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_trackPageview&#39;</span><span class="p">]);</span>
    <span class="nt">&lt;/script&gt;</span>
</code></pre></div>

<p>Then place your asynchronous call to load Google Analytics to somewhere just before your body tag:</p>

<div class="highlight"><pre><code class="html">    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
      <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ga</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span> <span class="nx">ga</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span> <span class="nx">ga</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">ga</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https:&#39;</span> <span class="o">==</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">?</span> <span class="s1">&#39;https://ssl&#39;</span> <span class="o">:</span> <span class="s1">&#39;http://www&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.google-analytics.com/ga.js&#39;</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="nx">s</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">ga</span><span class="p">,</span> <span class="nx">s</span><span class="p">);</span>
      <span class="p">})();</span>
    <span class="nt">&lt;/script&gt;</span>
</code></pre></div>

<p>Follow a similar hierarchy and you are set.</p>

<h3>Code Review</h3>

<p>The simplicity and ease-of-use speak for themselves. But, I also believe in sharing and I think there is much we can learn from dissecting the internals of Bindr.</p>

<p>All 579 bytes of the code base are broken up into three top level modules: The Event <em>Handler</em>, <em>Bindr</em> and <em>GetFileName</em>.</p>

<h4>Finding Closure</h4>

<p><a href="https://developer.mozilla.org/en/JavaScript/Guide/Closures">Closures</a> are often considered an advanced feature in JavaScript. A closure is a special kind of object that combines two things: a function, and the environment in which that function was created.</p>

<div class="highlight"><pre><code class="javascript">    <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="c1">//Event Handler</span>
    
    <span class="c1">//Bindr</span>
    
    <span class="c1">//Get true FileName from link pathname</span>
    
    <span class="p">})();</span>
</code></pre></div>

<p>Note the repeating open-and-close parenthesis. These tell the JavaScript interpreter to execute the anonymous function and it&#39;s internal business logic immediately.</p>

<p>Closures in JavaScript have many practical uses. Here, Bindr operates in its own scope with its own private methods and variables.</p>

<p>This means Bindr introduces no new Global variables. So there is no chance of objects from extension clobbering objects in your project.</p>

<p>Bindr is completely independent and self-contained. This means you can plug it into your own project - worry free! There&#39;s value there.</p>

<h4>Event Handler</h4>

<p>The event handler caches a list of document links. Then it assigns the Bindr callback to each link&#39;s <em>onclick</em> event. Many would create custom events to monitor this behavior, but I find the native onclick event more than adequate for the job.</p>

<div class="highlight"><pre><code class="javascript">    <span class="c1">//Event Handler</span>
    <span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
         <span class="c1">//Setup an onclick event handler for each link</span>
         <span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">links</span><span class="p">;</span>
         <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">//Call Bindr whenever the link is clicked</span>
             <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">Bindr</span><span class="p">;</span>
         <span class="p">}</span>
     <span class="p">};</span>
</code></pre></div>

<p>Also, it&#39;s important to note the <em>onload</em> event. Executing after the <em>onload</em> event has fired ensures the DOM is loaded by the time Bindr is ready to go to work.</p>

<p>Another interesting note here is the ever vigilant <em>for</em> loop. I could have used a for in loop like this:</p>

<div class="highlight"><pre><code class="javascript">    <span class="c1">//Potential Alternative to the traditional for loop</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">link</span> <span class="k">in</span> <span class="nx">links</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span><span class="p">(</span><span class="nx">links</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">link</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">Bindr</span><span class="p">;</span>      
       <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>

<p>The problem here is each link object is <a href="http://stackoverflow.com/questions/242841/javascript-foreach-vs-for">not ordered as you would expect</a>. Also, since hasOwnProperty is a method, it could be overwritten or replaced with an unexpected value. This could cause bugs that are hard to track.</p>

<p>Overall, I found the simple for loop fast, adequate and less prone to logic errors.</p>

<h4>Bindr</h4>

<p>Some interesting parts here too. JavaScript implements perl-style regular expressions. The <em>fileTypes</em> variable is a regular expression literal that lists the acceptable file types.</p>

<div class="highlight"><pre><code class="javascript">    <span class="c1">//Bindr</span>
    <span class="nx">Bindr</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">fileTypes</span> <span class="o">=</span> <span class="sr">/\.doc$|\.eps$|\.jpg$|\.png$|\.svg$|\.xls$|\.ppt$|\.pdf$|\.xls$|\.zip$|\.txt$|\.vsd$|\.vxd$|\.js$|\.css$|\.rar$|\.exe$|\.dmg$|\.wma$|\.mov$|\.avi$|\.wmv$|\.mp3$/i</span><span class="p">;</span>

        <span class="c1">//The link object is now available in &quot;this&quot;</span>
        <span class="kd">var</span> <span class="nx">pathname</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span> 
        <span class="kd">var</span> <span class="nx">fileName</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">autograph</span><span class="p">;</span>
            
        <span class="c1">//File type match found</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">fileTypes</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">//Get the file name</span>
            <span class="nx">fileName</span> <span class="o">=</span> <span class="nx">GetFileName</span><span class="p">(</span><span class="nx">pathname</span><span class="p">);</span>
                
            <span class="c1">//Add file to the Google Analytics Queue</span>
            <span class="nx">autograph</span> <span class="o">=</span> <span class="s1">&#39;/download/&#39;</span> <span class="o">+</span> <span class="nx">fileName</span><span class="p">;</span>
            <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_trackPageview&#39;</span><span class="p">,</span> <span class="nx">autograph</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">};</span>
</code></pre></div>

<p>Some of the more popular file downloads to track are: *.pdf and *.zip</p>

<p>Once you&#39;re in Bindr, that means the link&#39;s callback was called. At that point, the variable <em>this</em> now contains the link object. Here, the <em>pathname</em> is the link property of concern to us.</p>

<p>If the fileType is present in the whitelist, the <em>pathname</em> is used to extract the download&#39;s <em>fileName</em>. Then the download&#39;s <em>autograph</em> is added to the Google Analytics Queue.</p>

<p>I chose to use _trackPageview to track the file download. The download metric would then show under Top Content as a PageView metric.</p>

<p>Another option is to use _trackEvent to track the file download. In my mind, _trackPageview via Top Content felt more simple and accessible, so I chose that route. Reasonable minds could differ here, so I&#39;ll leave it to the SEO Experts to debate which is &quot;best&quot;.</p>

<h4>Get True FileName from Link Pathname</h4>

<p>Still with me? Good! <em>GetFileName</em> is probably thee most important method in Bindr!</p>

<div class="highlight"><pre><code class="javascript">    <span class="c1">//Get true FileName from link pathname</span>
    <span class="nx">GetFileName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pathname</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//Remove the anchor at the end</span>
        <span class="nx">pathname</span> <span class="o">=</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">length</span> <span class="o">:</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">));</span>
            
        <span class="c1">//Removes the query after the file pathname</span>
        <span class="nx">pathname</span> <span class="o">=</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">length</span> <span class="o">:</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">));</span>
            
        <span class="c1">//Removes everything before the last slash in the path</span>
        <span class="nx">pathname</span> <span class="o">=</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nx">pathname</span><span class="p">;</span>
    <span class="p">};</span>
</code></pre></div>

<p>It is incredibly difficult to extract a download&#39;s <em>fileName</em> from a link&#39;s <em>pathname</em> property.</p>

<p>There could be a hash (#) in the URL. You have to account for this.</p>

<p>There could also be a query (?) in the URL. You have to account for this. </p>

<p>And, of course, there is the fully qualified URL preceding the <em>fileName</em>. You have to account for this too.</p>

<p>You have to account for each situation and most times that isn&#39;t easy. Bindr accomplishes each scenario well, without bloated code or overcomplicated algorithms. Clean and Simple.</p>

<h3>The Big Picture</h3>

<p>The Big Picture is I believe you&#39;ll love Bindr. It&#39;s lightweight and standards based with measurable goals and forethought. </p>

<p>Bottom line is if you need to track downloads with Google Analytics, then don&#39;t roll your own framework. Download <a href="https://github.com/tiandavis/bindr">Bindr</a> and spend less time coding and more time working on your core business.</p>

<h3>Update: Bindr 1.1.0</h3>

<h4>10,000 Foot View</h4>

<p><strong>Single Global Variable:</strong> Inspect the DOM, you&#39;ll find a single Global Variable called <em>bindr</em>.</p>

<p><strong>Public and Private Members:</strong> Used the Module Design Pattern to establish both public and private object members. It&#39;s a little less restrictive than Object Literal Notation and gets the job done! Check the DOM, <em>getFileName</em> and <em>autograph</em> are not accessible outside the bindr namespace.</p>

<p><strong>Cleaner FileType Whitelist:</strong> Reduced the whitelist to the most popular file extensions. Added support for Office 2007 documents and Open Office documents.</p>

<p><strong>Strict Comparison:</strong> Used strict comparison on conditionals. Increases reliability and increases speed.</p>

<p><strong>Link Count Cache:</strong> Cached link.length for comparison during initialization. Link.length doesn&#39;t have to be calculated each iteration - this increases the performance.</p>

<p><strong>Global Namespace:</strong> Explicitly added Bindr to the Global Namespace.</p>

<p><strong>JSHint:</strong> Ran Bindr through JSHint - a fork of Douglas Crockford&#39;s JSLint. The Google Analytics Queue doesn&#39;t exist until the onclick event. It didn&#39;t like that, but that&#39;s expected. Also, it didn&#39;t like the <em>new</em> operator. Called it a &quot;Weird construction&quot;. I can deal with a little weird...Barring those two expected, I&#39;d say Bindr passed 100%.</p>

<h4>The Code</h4>

<p>See an overview of the code at 10,000 FT:</p>

<div class="highlight"><pre><code class="javascript">    <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bindr</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">VERSION</span> <span class="o">=</span> <span class="s2">&quot;1.1.0&quot;</span><span class="p">;</span>
        
        <span class="c1">//Get true FileName from link pathname</span>
        <span class="kd">var</span> <span class="nx">getFileName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pathname</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//No updates...</span>
    
            <span class="k">return</span> <span class="nx">pathname</span><span class="p">;</span>
        <span class="p">};</span>
    
        <span class="kd">var</span> <span class="nx">autograph</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">whitelist</span><span class="p">,</span> <span class="nx">pathname</span><span class="p">,</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">fileName</span><span class="p">,</span> <span class="nx">associate</span><span class="p">;</span>
            
            <span class="nx">whitelist</span> <span class="o">=</span> <span class="sr">/\.pdf$|\.zip$|\.od*|\.doc*|\.xls*|\.ppt*|\.exe$|\.dmg$|\.mov$|\.avi$|\.mp3$/i</span><span class="p">;</span>

            <span class="c1">//The link object is now available in &quot;this&quot;</span>
            <span class="nx">pathname</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span>
            
            <span class="c1">//Compare the fileType to the whitelist</span>
            <span class="nx">match</span> <span class="o">=</span> <span class="nx">pathname</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">whitelist</span><span class="p">);</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">match</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">match</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> 
            <span class="p">{</span>
                <span class="c1">//Get the file name</span>
                <span class="nx">fileName</span> <span class="o">=</span> <span class="nx">getFileName</span><span class="p">(</span><span class="nx">pathname</span><span class="p">);</span>
    
                <span class="c1">//Add file to the Google Analytics Queue</span>
                <span class="nx">associate</span> <span class="o">=</span> <span class="s1">&#39;/download/&#39;</span> <span class="o">+</span> <span class="nx">fileName</span><span class="p">;</span>
                <span class="nx">_gaq</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;_trackPageview&#39;</span><span class="p">,</span> <span class="nx">associate</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    
        <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">links</span><span class="p">;</span>
            
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="o">=</span><span class="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">//Call Bindr whenever the link is clicked</span>
                <span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="nx">autograph</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">})();</span> <span class="c1">//Bindr</span>
    
    <span class="c1">//Add bindr to the global namespace</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">bindr</span> <span class="o">=</span> <span class="nx">bindr</span><span class="p">;</span>
    
    <span class="c1">//Execute onload - ensuring links are present in the DOM</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">bindr</span><span class="p">.</span><span class="nx">initialize</span><span class="p">;</span>
    <span class="p">})();</span>
</code></pre></div>

<h4>Usability and User Experience</h4>

<p>I follow a couple core principles when it comes to designing products. At the base of the pillar is Usability and User Experience. I kept _trackPageview because I believe it is more usable and provides a better tracking experience.</p>

<p>From discussion, I think we&#39;ve seen that neither _trackEvent or _trackPreview offer the &quot;perfect&quot; solution. Both skew the data. Analyzing my own Google Analytics data, I can say - with peace of mind - the skew is neglible at best.</p>

<p>Once the data is skewed, I believe the question of which method skews the data most is less relevant than thee most important metric - Usuability.</p>

<p>I setup an experiment to test this idea. One implemented Bindr as a _trackEvent and the other as a _trackPreview. To get access to download count for a file, I found this:</p>

<p><strong>_trackPageview</strong>
2 clicks</p>

<p><strong>_trackEvent</strong>
4 clicks</p>

<p>Two extra clicks for _trackEvent. That really is a big deal! But, even if I find it negligible, what wasn&#39;t negligible was how I felt using Top Content via _trackPageview versus Event Tracking via _trackEvent.</p>

<p>Using Top Content, I felt the User Interface was easier to use and I felt like I could get to my data quicker. I felt the opposite with Event Tracking.</p>

<p>With Event Tracking, I felt the segmentation was overkill and I felt it wasn&#39;t necessarily suited for the file tracking problem domain. I could understand if I had an app or video where I wanted to track feature usage - I get that! But here, all I want to do is track file downloads and I felt Event Tracking got in the way more than it helped.</p>

<p>Of course, other than the extra two clicks, everything I&#39;ve said about Event Tracking is purely subjective. It&#39;s how I feel about that aspect of Google Analytics&#39; Interface. Others - no doubt - will have their own personal opinion. I&#39;m Ok with that! Please feel free to express the same in the comments.</p>

<p>Unfortunately or Fortunately - I&#39;m undecided - you can find sources supporting either side on whether we should use _trackPageview or _trackEvent.</p>

<p>Maybe it&#39;s just me, but maybe our Google Overloads want us to realize something:</p>

<p><em>It&#39;s more important how you use the data than how you view it.</em></p>

</div>
				</div>
					
			</div><!-- container -->

			<div class="resize"></div>
	
</body></html>